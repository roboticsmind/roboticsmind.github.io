# Maison connectée  

Ce projet  a été réalisé par : 
- Ammar ALSADIK : ammar_alsadik@yahoo.com (11601920);
- Julian CHAMBRIER : julianchambrier@hotmail.fr (11601367).

 <img src="./doc/img/construction7.png" alt=""/>
 
 ## Notre maison connectée en vidéo  

[Voir la vidéo de notre maquette (version longue)](https://www.youtube.com/watch?v=YRuSDZIuBYg)  
[Voir la vidéo de notre maquette (version courte)](https://www.youtube.com/watch?v=Yi7izP-IfhY) 

## Description du projet

  Avec l'essor des objets de plus en plus connectés, de nombreuses personnes aimeraient pourvoir connecter des objets courants afin d'amener de la praticité et de la facilité dans leur quotidien. C'est à partir de cette constatation que le terme de la "maison connectée" est apparu.  
  
De nous jours, de plus en plus de maisons deviennent connectées grâce à la domotique. Très longtemps chère et lourde à mettre en place, la domotique a su s'imposer et est, aujourd'hui, présent dans de nombreux foyers.   
  
La sécurité, la communication ou encore la l'économie d'énergie sont des exemples de domaines que touche la domotique.  
	
La maison intelligente a pour objectif de faciliter les actions du quotidien, d'automatiser des tâches, d'avoir un foyer plus sécurisé ou encore de réduire son impact écologique.  

## Etat de l'art
  
Aujourd'hui, le marché de la maison connectée est en plein essor. On estime à **6 milliards d'euros le chiffre d'affaire** engendré par les objets connectés dans les maisons en France avec par exemple **650 millions d'euros** rien que pour l'électroménagers intelligents.  
On estime à **30 millions** le nombre de maisons connectées soit **7.1%** des foyers français équipés d'une solution domotique. Ces données suivent une progression à deux chiffres. 

 <img src="./doc/img/croissanceMaisonConnectee.png" alt=""/>
  
Dans le monde cela représente un marché entre **50 et 80 Milliards** de chiffre d'affaire pour **20.4 Milliards d'objets connectés** en 2020 selon Gartner. 

Les principaux marchés se situent dans les pays développés avec en top position les Etats-Unis, le Japon et l'Allemagne. La France arrive en 5e position. 

En Europe, le podium concernant la part des logements équipés d'appareils connectés est occupé par la Suède, le Danemark et les Pays-Bas. La France arrive en 7e position. 

<img src="./doc/img/chiffresEurope.png" alt=""/>

Le paradoxe est que le chiffre d'affaire engendré par les objets connectés dans les maisons est plus important en France qu'en Suède, comme décrit précédemment. Ceci s'explique avec le nombre d'objets connectés moyen présents dans une maison, plus élevé en France que dans les autres pays d'Europe.  

En 2017, une personne sur trois déclare avoir l'intention d'acheter un objet connecté pour sa maison. Soit **13%** de plus que 2016.
    Les points qui intéressent le plus les gens sont les alarmes connectées notamment avec les caméras intelligentes, l'éclairage pilotable et variable ou encore les systèmes de gestion de la température.

Au vue de la croissance dans ce domaine, de nombreux acteurs proposent de connecter sa maison. Cette connexion passe par tous les objets du quotidien. De ce fait, des entreprises d'électroménagers, de jardinage, de bricolage ou encore d'électronique proposent des produits et services afin de rendre intelligente votre maison. A l'instar de Castorama, Darty ou Verisure  qui proposent respectivement des portails, de l'électroménager et des alarmes connectées.  
	
Ce boom des objets connectés dans les maisons à contraint de mettre en place des normes permettant de garantir la sécurité des systèmes ou encore de protéger les données privées. L'organisation internationale de normalisation se charge de mettre en place des nouvelles normes concernant les objets connectés, en particulier des **normes ISO**. Nous avons par exemple la norme ISO/IEC 30141 qui permet d'établir une architecture de référence normalisée de manière internationale. Afin de proposer un vocabulaire commun, des schémas conceptuels réutilisables et les meilleures pratiques du secteur. Ou encore la norme ISO/IEC 27701 garantissant la protection des données personnelles.
	
  Dans une maison, tous les objets peuvent être connectés. On peut planifier l'arrosage automatique et la fermeture automatique des volets, allumer des lumières avec son Smartphone, ouvrir automatiquement son portail, avoir une alarme connectée ou encore gérer son chauffage à distance. 
	
  Nous proposons donc de réaliser une maquette d'une maison connectée. Cette maquette permettra de gérer son portail, ses portes d'entrées, sa lumière, son arrosage automatique, ses volets, son chauffage, son alarme….
	
  Aujourd'hui, le coût des objets connectés dépasse rarement le millier d'euro individuellement. En effet, une bonne alarme connectée coûte mille euros, une lampe connectée 100€, un portail électrique 400€ ou encore des volets électriques 200€ par volet.  
  
#### Intégration de nos fonctionnalités à votre habitation

Le but d'un tel projet est qu'il soit transposé à la réalité. De ce fait, toutes nos fonctionnalités sont intégrables et transposables à votre habitation.  
Afin de vous guidez, nous vous présentons ce que vous pouvez trouver dans le commerce par rapport aux fonctionnalités que nous avons intégré à notre maquette.

| Composants              				| Prix moyen (TTC)|
| :----------------------------------------------------:|:---------------:|
| Motorisation de portail 				| 450€            |
| Motorisation porte de garage       			| 225€     	  | 
| Lecteur de badges et motorisation de porte entrée     | 265€            |
| Motorisation volet					| 200€/volet	  |
| Alarme 						| 800€		  |
| Climatisation						| 900€    	  |
| VMC							| 150€            |
| Arrosage automatique (avec application)		| 300€		  |
| Eclairage (avec application) 				| 35€/ampoule     |

Notons que les prix varient en fonction des enseignes. Mise bout à bout les dépenses augmentent très vite, mais un individu peut décider de prioriser certains objets connectés par rapport à d'autre. Par exemple, quelqu'un qui vit dans un appartement n'aura pas forcement besoin d'un portail automatique.

## Etude fonctionnelle

### Contexte

Aujourd'hui beaucoup de personnes désirent une maison connectée. On ne déroge pas à la règle.  

Cette idée est venue de notre quotidien. 

En effet, nous avons tous envie d'appuyer sur un simple bouton pour ouvrir notre portail, d'être rassuré quant à la sécurisation de notre maison lorsque nous sortons de chez nous, de réduire notre impact écologique et énergétique ou encore de gérer différents systèmes à distance.   

C'est dans cette idée que nous avons voulu construire notre propre maison connectée.  

### Les débouchés

C'est donc à partir de ces observations que nous avons commencé à regarder ce qu'on aimerait intégrer dans notre projet.
On voulait pouvoir gérer facilement et rapidement les ouvertures, intégrer des choses originales comme un arrosage automatique piloté avec une application Android, ou encore amener du confort à l'habitation.  

De plus, on voulait réaliser des choses qui serait reproductible à l'échelle humaine. Ainsi, il faut avoir une vision humaine. En effet, la plupart d'entre nous ne veulent pas qu'une fonctionnalité soit trop onéreuse ou trop complexe à mettre en place.

Il a fallu donc réfléchir à ces aspects avant de nous lancer dans le projet.

## Nos objectifs 
	
Afin de réaliser la maquette nous allons utiliser des composants très peu onéreux et donc accessibles de tous.  
	
Notons que d'autres groupes d'IOT ont déjà réalisé une maison connectée, mais nous choisissons de ne pas s'inspirer de leur projet afin de proposer un projet personnel.   
  
 Afin d'effectuer ce projet, nous allons mettre en place :
 
 - Faire une maquette (en dur) de la maison avec son jardin
 - Ajouter à cette maquette :
 	- Un portail automatique;
	- Une porte de garage automatique;
	- Deux volets automatiques et intelligents;
	- Une porte d'entrée automatique et sécurisé;
	- Une alarme connectée;
	- Un système de régulation d'humidité et de température;
	- Un système de gestion de l'éclairage et de l'arrosage automatique via une application Android.
	
## Modélisation

**Diagramme d'utilisation** décrivant les actions réalisables par l'utilisateur et par le système de contrôle de la maison.

 <img src="./doc/img/useCaseUML.png" alt=""/>
 
## Diagramme de Gantt

 <img src="./doc/img/Diagramme_Gantt.png" alt=""/>   
 
Ce projet représente environ 184 heures de travail. Dans ces 184 heures, nous avons 100 heures pour la construction de la maquette, 79 heures de développement du code des microcontrôleurs, de l'application Android, des les fonctionnalités embarquées et de la modélisation des branchements (Fritzing) du projet et 5 heures pour la conception et l'achat des matériaux.

## Diagramme de navigation de l'application Android

 <img src="./doc/img/navigationUML.png" alt=""/>  
 
## Les composants 

Afin de réaliser ce projet, nous avions besoin de composants électroniques mais aussi de matériaux de constructions.

[Voir les composants](https://github.com/institut-galilee/2020-SmartHomeJA/blob/master/doc/composants.md)

## Les logiciels utilisés  

Pour réaliser ce projet, nous avons utilisé différents logiciels.  

#### IDE Arduino 

L'environnement de développement Arduino permet de faire de la programmation en langage C pour les microcontrôleurs. Il est téléchargeable gratuitemement sur la page [Arduino](https://www.arduino.cc/en/main/software).  
Nous avons utilisé la dernière version (1.8.12).  
Pour programmer un microcontrôleur, il suffit d'écrire un programme dans les sections **_Setup_**, pour les initialisations et **_Loop_**, pour le programme qui tourne en boucle à l'allumage de microcontrôleur.  

#### Fritzing 

Fritzing est un logiciel téléchargeable gratuitement sur la page [Fritzing](https://fritzing.org/home/). Il existe une version payante, mais la version de base suffit amplement pour l'utilisation qu'on en a faite.  

Il va permettre de faire les schémas électroniques des différents branchements réalisés au cours du projet. Cela va permettre d'avoir à porter de mains les schémas des branchements qui vont permettre de faciliter nos branchements dans la maquette et permettant à chacun de connaître d'un coup d'oeil les branchements sans à avoir à ouvrir la maquette.  

#### Blender

Blender est un logiciel de montage vidéo.  
Nous avons utilisé la version 2.81, il est téléchargeable gratuitement sur la page [Blender](https://blender.fr.softonic.com/).  
Il nous a permis de monter la vidéo afin d'intégrer du texte, et mettre deux vidéos sur un même écran en même temps.

#### AppInventor

AppInventor permet de créer des applications mobiles et tablettes sous Android.  
Il est accessible depuis la page [AppInventor](https://appinventor.mit.edu/) totalement gratuitement.
Il évite de longue période de développement, de conception et d'implémentation. Tout est intégré.  
Ce logiciel a été développé par le MIT et l'implémentation grâce à des blocks est très intuitif et offre une rapidité de prise en main. Il nous a permis de développer nos deux versions de l'application pour notre maquette.

## Avancement du projet

[Voir l'avancement du projet](https://github.com/institut-galilee/2020-SmartHomeJA/blob/master/doc/avancement.md)  

[Voir la construction de la maquette jour par jour](https://github.com/institut-galilee/2020-SmartHomeJA/blob/master/doc/construction_maquette.md)

## Branchements des composants

[Voir les branchements des microcontrôleurs](https://github.com/institut-galilee/2020-SmartHomeJA/blob/master/doc/branchements.md)

## Codes

[Voir code Application/Température/Humidité/Eclairage/Arrosage](https://github.com/institut-galilee/2020-SmartHomeJA/blob/master/src/codeAduinoApp_TempHumi_Alarme.md)  
  
[Voir code des ouvertures de la maison](https://github.com/institut-galilee/2020-SmartHomeJA/blob/master/src/codeArduinoOuvertures.md)  

[Voir code de l'application](https://github.com/institut-galilee/2020-SmartHomeJA/blob/master/src/codeApplication.md)

## Prix et magasins des éléments achetés

[Voir le prix/magasins des éléments de la maquette](https://github.com/institut-galilee/2020-SmartHomeJA/blob/master/doc/prix.md)

## Fonctionnalités finales de notre maison connectée  

La version finale de notre maquette de la maison connectée intègre plusieurs fonctionnalités. 

### Les ouvertures 

Toutes les ouvertures de notre maquette sont automatisées. Elles fonctionnent toutes avec un moteur pas à pas et grâce au contrôle du microcontrôleur.

- **Le portail** : il fonctionne grâce à une télécommande infrarouge, un récepteur infrarouge et une led. Lorsque l'utilisateur appuie sur la flèche de droite de la télécommande le portail s'ouvre et si l'utilisateur appuie sur la flèche de gauche le portail se ferme. Durant le mouvement du portail, une led clignote afin d'avertir son utilisateur que le portail est en mouvement.  
- **La porte de garage** : elle fonctionne grâce à une télécommande et un récepteur tout deux infrarouges. Lorsque l'utilisateur appuie sur la flèche du haut de la télécommande la porte de garage s'ouvre et si l'utilisateur appuie sur la flèche du bas la porte de garage se ferme.
- **La porte d'entrée** : elle fonctionne avec un module RFID, un badge et deux leds. Lorsque l'utilisateur passe un badge valide (reconnu par le lecteur) la porte s'ouvre/se ferme et une led verte s'allume. Si le badge n'est pas reconnu, c'est que l'utilisateur n'a pas l'autorisation d'entrer, ainsi la porte ne s'ouvre/se ferme pas et un led rouge suivi d'un **_bip_** du buzzer. De ce fait, elle est automatisée (elle s'ouvre/se ferme toute seule) et sécurisée (elle filtre les entrées dans la maison).
- **Les volets** : ils fonctionnent avec une télécommande infrarouge et un récepteur infrarouge. Lorsque l'utilisateur veut ouvrir ses volets, il appuie sur la **_touche 1_** pour celui de la chambre et **_touche 3_** pour celui de la cuisine. S'il veut les fermer, il appuie sur la **_touche 7_** pour celui de la chambre et **_touche 9_** pour celui de la cuisine. De plus, si les volets sont ouverts et que la nuit commence à tomber, ils se ferment automatiquement afin de conserver la chaleur dans la maison. Cela permet d'avoir une maison plus économe en énergie.

### Les systèmes intelligents  

Notre maison a d'autres systèmes permettant d'amener du confort, de la praticité et de la sécurité à ses propriétaires.

- **L'alarme connectée** : elle fonctionne grâce à une module LCD, un pavé numérique, une détecteur de mouvements, des leds et un buzzer. Lorsque l'utilisateur souhaite l'activée, il appuie sur le bouton **A** (comme Activation). De ce fait, l'alarme s'arme après 3 secondes, et une led rouge s'allume. Si un mouvement est détecté alors que l'alarme est armée, une led jaune signifiant un mouvement s'allume et elle se déclenche en faisant sonner un buzzer. Pour la désactiver, il suffit d'entrer le bon mot de passe (par défaut 1234), ce qui entrainera la désactivation du buzzer (s'il sonne) et la led verte s'allumera. La touche **C** (comme Clean) permet d'effacer l'entrée en cas d'erreur de saisie sur le pavé numérique. Notons que les leds (verte et rouge) correspondent à l'état de l'alarme, si la led verte est allumée, l'alarme est désactivée, si la led rouge est allumée, elle est activée, si les deux sont allumées, l'alarme est en activation/désactivation. L'écran LCD affiche l'état de l'alarme (activé ou désactivé) et **_code erroné_** en cas d'erreur de saisie de l'utilisateur.
- **Le système de régulation de la température/humidité** : il fonctionne grâce à un module LCD, une capteur DHT11 de température et d'humidité et un ventilateur (moteur DC avec palme). Ce système est entièrement autonome. Si la température dépasse 30°C ou l'humidité dépasse 65%, le ventilateur s'actionne afin de réguler ces données. Lorsque ces valeurs sont sous leur seuil, la ventilation s'arrête. C'est une sorte de climatisation et de ventilation mécanique contrôlée (VMC). Le module LCD permet d'affiché, en temps réel, la témpérature et l'humidité dans la maison.
- **L'application Android** : 
	- **Généralité** : cette application existe pour Smartphone et pour tablette. Elle fonctionne avec une communication Bluetooth. Elle va permettre à son utilisateur de se connecter aux systèmes de sa maison. Pour se connecter à sa maison, il suffit d'appuyer sur le bouton en haut à gauche (bouton Bluetooth) et de choisir le bon module Bluetooth (00:14:03:05:5A:71 HC-06). Dans ce cas le message **_Bluetooth non connecté_** écrit en rouge passe au message **_Bluetooth connecté_** écrit en vert. L'utilisateur peut ainsi effectuer les actions fournies par l'application. Pour se déconnecter, il appuie sur le bouton en haut à droite (bouton porte de sortie), ce qui déconnectera le module Bluetooth et l'application. Dans ce cas le message **_Bluetooth connecté_** écrit en vert passe au message **_Bluetooth non connecté_** écrit en rouge. L'application permet aussi de gérer la reconnaissance vocale grâce au bouton en haut au milieu (bouton micro). Ainsi l'utilisateur a le choix entre appuyer sur un bouton ou parler pour faire une action. De plus, sur l'écran d'accueil de l'application, la température et l'humidité de la maison sont affichées. Cela permet aux habitants de connaître ces valeurs partout dans sa maison.
	- **Pour l'éclairage** : L'application permet de contrôler les éclairages de toutes les zones de la maison (jardin, garage, salon, cuisine et chambre). Pour allumer une zone l'utilisateur appuie sur le bouton correspondant à la bonne zone ou appuie sur le bouton de reconnaissance vocale et dit **_Allumer nom_de_la_zone_** (ex: Allumer jardin). Pour éteindre une zone l'utilisateur appuie sur le bouton correspondant à la bonne zone ou appuie sur le bouton de reconnaissance vocale et dit **_Eteindre nom_de_la_zone_** (ex: Eteindre jardin). L'utilisateur peut aussi dire **_Eteindre tout_** ou appuyer sur le bouton **_Eteindre tout_** de l'application, ce qui aura pour conséquence d'éteindre toutes les zones encore allumées de la maison.
	- **Pour l'arrosage** : L'application permet aussi de contrôler l'arrosage automatique de la maison. Il fonctionne grâce à une pompe à eau. Il est activé comme pour l'éclairage de la maison, soit avec un bouton directement sur l'application soit par reconnaissance vocale. Si l'utilisateur dit **_Allumer arrosage_** ou **_Eteindre arrosage_**, l'arrosage automatique va s'activer/ se désactiver. L'eau qui sort de l'arrosage est puisé directement dans un réservoir, parcourt une canalisation et se déverse dans le réservoir. On a donc un système en série.

Ainsi notre maison connectée intègre des systèmes qui vont amenés de la praticité (avec l'automatisation des ouvertures et l'application Android), de la sécurité (avec l'alarme) et du confort (avec la climatisation) à ses propriétaires.

	
